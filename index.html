<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ESSENCE OMNIVERSE | OFFICIAL STORE</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Inter:wght@300;400;800&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #b8952e; --b: #000; --w: #fff; --f: #f8f8f8; }
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter', sans-serif; }
        body { background: var(--w); color: var(--b); padding-top: 80px; }

        /* HEADER */
        header { 
            height: 80px; width: 100%; position: fixed; top: 0; background: #fff; 
            display: flex; justify-content: center; align-items: center; 
            border-bottom: 1px solid #eee; z-index: 10000; 
        }
        .logo { font-family: 'Cinzel'; font-size: 1.5rem; letter-spacing: 10px; font-weight: 900; cursor: pointer; }

        /* GRID */
        .catalog { 
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; 
            padding: 20px 5%; max-width: 1200px; margin: 0 auto; 
        }
        .card { border: 1px solid #f0f0f0; padding: 15px; background: #fff; transition: 0.3s; }
        .card:hover { border-color: var(--gold); }
        .img-box { aspect-ratio: 1/1; background: var(--f); display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .img-box img { width: 90%; object-fit: contain; }
        
        .name { font-size: 0.8rem; font-weight: 800; text-transform: uppercase; margin: 15px 0 5px; height: 35px; overflow: hidden; }
        .price { font-size: 1.1rem; font-weight: 300; color: #666; margin-bottom: 15px; }

        .btn-wa { 
            width: 100%; padding: 15px; background: #000; color: #fff; border: none; 
            font-size: 0.7rem; font-weight: 900; letter-spacing: 2px; cursor: pointer;
        }

        /* ADMIN UI */
        .fab { 
            position: fixed; bottom: 30px; right: 30px; width: 65px; height: 65px; 
            background: #000; color: #fff; border-radius: 50%; display: none; 
            align-items: center; justify-content: center; font-size: 1.5rem; z-index: 10001; 
        }
        .modal { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(255,255,255,0.98); z-index: 20000; 
            align-items: center; justify-content: center; flex-direction: column; padding: 20px; 
        }
        .modal input { width: 100%; max-width: 400px; padding: 15px; margin-bottom: 10px; border: 1px solid #ddd; }
        
        @media (min-width: 768px) { .catalog { grid-template-columns: repeat(4, 1fr); } }
    </style>
</head>
<body>

    <header><div class="logo" id="boss-key">ESSENCE</div></header>

    <main class="catalog" id="lista-perfumes"></main>

    <div class="fab" id="add-btn" onclick="openM()">+</div>

    <div class="modal" id="modal-add">
        <h2 style="font-family:'Cinzel'; margin-bottom:20px;">NUEVO INGRESO</h2>
        <input id="nom" placeholder="Nombre de la fragancia">
        <input id="pre" type="number" placeholder="Precio ($)">
        <input id="img" placeholder="URL de la imagen">
        <button class="btn-wa" onclick="subir()">PUBLICAR EN CATÁLOGO</button>
        <p onclick="closeM()" style="margin-top:20px; cursor:pointer; font-size:0.7rem; font-weight:900;">CERRAR</p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        // TU CONFIGURACIÓN PROBADA
        const config = {
            apiKey: "AIzaSyBkNAkJXoyxn9rkGv1mG5GPh9ge4FUjp8Y",
            authDomain: "essencev2.firebaseapp.com",
            projectId: "essencev2",
            storageBucket: "essencev2.firebasestorage.app",
            messagingSenderId: "201967001425",
            appId: "1:201967001425:web:0a072cd4d2048e7a0dbd70"
        };

        const app = initializeApp(config);
        const db = getFirestore(app);
        const col = collection(db, "perfumes_test"); // Usamos la misma que el debug para asegurar éxito

        // MOTOR DE CARGA (Basado en el Debug que sí funcionó)
        onSnapshot(col, (snap) => {
            const grid = document.getElementById('lista-perfumes');
            grid.innerHTML = "";
            snap.forEach(d => {
                const p = d.data();
                grid.innerHTML += `
                    <div class="card">
                        <div class="img-box"><img src="${p.i}"></div>
                        <div class="name">${p.n}</div>
                        <div class="price">$${p.p}.00</div>
                        <button class="btn-wa" onclick="window.open('https://wa.me/50769028805?text=Quiero%20${p.n}')">SOLICITAR</button>
                    </div>
                `;
            });
        });

        // MOTOR DE SUBIDA (Fuerza Bruta)
        window.subir = async () => {
            const n = document.getElementById('nom').value;
            const p = document.getElementById('pre').value;
            const i = document.getElementById('img').value;
            if(n && p && i) {
                try {
                    await addDoc(col, { n, p, i });
                    alert("¡PUBLICADO EXITOSAMENTE!");
                    closeM();
                    document.getElementById('nom').value=""; document.getElementById('pre').value=""; document.getElementById('img').value="";
                } catch (e) { alert("Error: " + e.message); }
            } else { alert("Completa los datos"); }
        };

        // ACCESO JEFE
        window.openM = () => document.getElementById('modal-add').style.display='flex';
        window.closeM = () => document.getElementById('modal-add').style.display='none';
        
        let clicks = 0;
        document.getElementById('boss-key').onclick = () => {
            clicks++;
            if(clicks >= 3) {
                if(prompt("PASS:") === "542497") {
                    document.getElementById('add-btn').style.display = 'flex';
                    alert("MODO JEFE ACTIVO");
                }
                clicks = 0;
            }
        };
    </script>
</body>
</html>






